## 主机

在「DevOps平台」中点击上方导航栏中「主机」标签，展开相应功能列表。

## 查询功能

* 条件查询：勾选集群及主机组的下拉列表中的数据，点击「查询」查看主机信息。
* 模糊查询：在查询文本框中输入IP，备注等模糊信息，点击「查询」查看主机信息。
* 勾选上"显示已删除主机"，点击查询后已经删除的主机信息也会展示在页面中。

##  导入主机

将各种类型的虚机或物理机导入FIT2CLOUD后，可以通过统一管理，有效地降低运维成本，特别是当主机数量很多时，能显著地提升运维效率。

###  Linux 主机导入 

目前支持导入 Linux 的主机类型包括 AWS Linux，Ubuntu，CentOS，RedHat，OpenSuse 等主流 Linux 发型版本。导入 Linux 主机的途径有四种：

* 导入云账号下的主机

* 在主机上执行脚本导入

* SSH方式导入单台主机

* SSH方式导入多台主机(CSV)

  *  导入云账号下的主机： 
        * 在主机列表界面，点击导入主机
    
        *  在弹出界面中选择云账号导入，选择需要导入主机的云账号，会弹出云主机列表界面

        *  在云主机列表界面，勾选需要导入的主机点击「导入主机」
     
        *  进入导入主机页面填写正确的导入信息，完成导入。

==注意：==

* 如果选择自动安装，会要求输入 SSH 信息，填写正确的 SSH 信息后，会自动导入

* 如果选择手动安装，点击导入后会立即成功，后续可点击主机中的“等待手动导入”按钮，生成导入脚本，在虚机中执行即可。

   * 在主机上执行脚本导入 

     * 在主机列表界面，点击导入主机
     
     * 在弹出界面中选择执行脚本导入，点击下一步弹出脚本内容页面，注意选择 Linux 导入脚本，然后复制脚本。

     * 在待导入主机上，以 root 用户身份执行刚才复制的脚本，不出意外，脚本执行成功后会提示，之后在 FIT2CLOUD 中会自动出现导入的主机。

   * SSH方式导入单台主机

     * 在主机列表界面，点击导入主机

     * 在弹出界面中选择 SSH 方式导入单台主机，输入 SSH 信息，注意：如果是 SSH 是非 root 用户登录，确保该用户可以通过 sudo 无密码获取 root 权限，则也可以正常导入。

    * SSH方式导入多台主机(CSV)
    
        * 在主机列表界面，点击导入主机
        
        * 在弹出界面中选择 SSH方式导入多台主机 (CSV)，点击下一步，会提示上传 CSV 文件，界面中有相应示例文件下载。
        
        * 上传成功后，点击导入即可。

###  Windows 主机导入 

Windows 主机目前支持 Windows 2013 后所有版本。Windows 导入方式目前只支持通过执行脚本导入。具体步骤如下：

* 在主机列表界面，点击导入主机

* 在弹出界面中选择在主机上执行脚本导入，点击下一步弹出脚本内容页面，注意选择 Windows 导入脚本，然后复制脚本。

* 在待导入主机上，以 administrator 用户身份，通过 CMD 或者 Powershell 执行刚才复制的脚本，不出意外，脚本执行成功后会提示，之后在 FIT2CLOUD 中会自动出现导入的主机。

###  AIX 主机导入

AIX 是 IBM 旗下的小型机操作系统，广泛的用于金融系统中，其内核基于 Linux，目前支持通过执行脚本的方式导入。具体步骤如下：

* 下载导入依赖包，并上传到AIX主机，下载地址：http://f2c-repo-pub.oss-cn-hangzhou.aliyuncs.com/eventagent/aix/f2c-aix-runtimes-0.1.tar.gz

* 登录AIX，安装导入依赖包，正常情况下，会提示安装成功。

```
cd **/**opt**/**fit2cloudgzip **-**d
f2c**-**aix**-**runtimes**-**0.1**.**tar**.**gztar **-**xvf
f2c**-**aix**-**runtimes**-**0.1**.**tarcd
f2c**-**aix**-**runtimes**-**0.1rpm **-**ivh
wget**-**1.9**.**1**-**1.aix5**.**1.ppc**.**rpmrpm **-**ivh
unzip**-**5.51**-**1.aix5**.**1.ppc**.**rpmrpm **-**ivh
bash**-**4.2**-**3.aix6**.**1.ppc**.**rpmbash install**.**sh 
```


* 在主机界面，点击导入主机，选择执行脚本导入，选择 AIX，复制脚本到 AIX 主机执行，正常情况下会提示导入主机成功，在主机页面上会出现相应的主机信息。

## 创建主机

FIT2CLOUD 具备自服务能力，通过 FIT2CLOUD，可以快速的创建各个云平台上的主机资源。
* 点击「创建主机」进入创建主机窗口
    * 选择目标集群：通过下拉列表的方式勾选您想要把您的主机创建在哪个集群下
    * 选择主机组：通过下拉列表的方式勾选您想要把您的主机创建在哪个主机组下
    * 选择主机创建模版：通过下拉列表的方式勾选您想要通过哪个模版来创建您的主机
    * 要创建的主机数量：选择您本次想要一次性创建主机的个数
* 创建完成后请查看agent状态，若显示"等待手动安装"请点击该标志，将弹出的"手动安装Agent脚本"界面中的脚本内容复制并粘贴到该主机下，进行手动安装。

## 更多操作 
在此功能选项中可以对所选主机进行以下的操作：
* 设置标签: 为所选的主机设置一个标签(包括新增和修改)
* 绑定密码密钥: 为所选的主机绑定一个秘密或者密钥用于登录主机
* 变更SSH端口：为所选的主机变更一个新的SSH端口
* 设置管理者：为所选主机设置一个管理者，主要是为了当主机发生告警时，向该管理者发出通知
* 同步主机信息：点击后刷新同步该主机记录的最新信息 
* 变更主机组：变更所选主机到一个其它的主机组目录下
* 启动主机：打开主机状态是已停止的主机电源
* 停止主机：关闭主机状态是运行中的主机电源
* 删除主机：分两种情况：
    * 对于创建的主机，点击主机页面的更多操作->删除主机，会调用云平台 API 真实删除主机

    * 对于导入的主机，点击主机页面的更多操作->删除主机，仅仅删除 FIT2CLOUD 上主机记录，不会影响原来主机运行。

## 操作

我们在每台主机的信息展示中都可以看到「操作」这项功能列表，点开后可以对指定的主机进行以下操作：

* 登录主机：另切一个浏览器窗口远程登录主机，这样更加方便我们对主机的操作
* 执行脚本：快速进入执行脚本页面，在该页面下可以：

    *   选择目标主机组
    *   选择目标主机
    *   选择脚本平台
    *   选择脚本解释器
    *   选择目标脚本
    *   设置脚本参数
    
通过「执行」按钮您也可以快速查看脚本执行日志，可以进行「查看脚本」和「查看日志」操作。

* 查看登录信息: 在输入当前用户正确的密码后，可以查看SSH的登录信息
* 查看监控数据：可以查看指定一段时间(如：30分钟，1小时，半年等)默认的监控概览，也可以查查自定义的监控 **(具体的自定义监控配置请见监控告警章节)** 默认的监控概览有：
    * CPU使用率
    * 一分钟平均负载
    * 内存使用率
    * 内存使用量
    * 磁盘IO使用率
    * 磁盘最高使用率
    * 网络速率

* 查看部署记录：查看指定主机下代码部署详情

* 查看脚本执行记录：查看指定主机的脚本执行部署详细日志

* 查看标签：查看指定主机的所设置的标签，在点开后的页面中您也可以新建和删除任意标签
* 停止主机：关闭指定主机的电源

### 其他操作

* 刷新功能：
    * 自动刷新：勾选后每30秒自动刷新主机页面
    * 立即刷新：页面右上角的「刷新」，点击立即刷新一次主机页面

* 导出功能：
    页面右上角「导出」，点击后确认选择导出路径，将在制定路径下导出一份主机页面信息的EXCLE表格。
* 字段显示设置：页面右上角「字段显示设置」，点开候可以自定义选择主机页面想要显示的字段。

* 告警：若有触发告警的主机，那么在该主机页面下的「告警」项中就会有警告提示标志，点击该标志可以快速进入告警查询页面，查看详细的告警信息。 