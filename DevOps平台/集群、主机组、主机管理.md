## 4.1 集群、主机组、主机概念 {#4-1}

| 名称 | 描述 |
| --- | --- |
| 集群 | FIT2CLOUD 以应用视角管理基础设施，集群是 FIT2CLOUD 提供的逻辑概念，用户可以按照地域，业务类型等自定义集群。 |
| 主机组 | 一个集群包含多个主机组，用户可以按照主机上运行的具体业务角色，创建不同的主机组。 |
| 主机 | 一个主机组包含多个角色一致或者相近的主机，主机即是具体环境中的一台虚机或者物理机。 |

## 4.2 集群、主机组的创建／修改 {#4-2}

1）在集群页面，点击新建按钮，可以创建一个新的集群，填入集群名称和集群描述，集群名称在当前用户环境下是唯一的。同时可以选择所属项目，项目是和费用管理挂钩的，具体可以参考费用管理章节。

2）在主机组页面，点击新建按钮，可以创建一个新的主机组，填入主机组名称和主机组描述以及主机所属集群，主机组名称在当前集群环境下是唯一的。

## 4.3 主机导入与管理 {#4-3}

将各种类型的虚机或物理机导入FIT2CLOUD后，可以通过统一管理，有效地降低运维成本，特别是当主机数量很多时，能显著地提升运维效率。

### 4.3.1 Linux 主机导入 {#4-3-1-linux}

目前支持导入 Linux 的主机类型包括 AWS Linux，Ubuntu，CentOS，RedHat，OpenSuse 等主流 Linux 发型版本。导入 Linux 主机的途径有三种：

1）导入云账号下的主机

2）在虚拟机上通过执行脚本导入

3）通过 SSH （或者定义好 SSH 信息的CSV文件）导入

#### 4.3.1.1 通过云账号方式导入： {#4-3-1-1}

1）在主机列表界面，点击导入主机

2）在弹出界面中选择云账号导入，选择需要导入主机的云账号，会弹出云主机列表界面

3）选择云主机列表中的主机，点击导入。

1.  如果选择自动安装，会要求输入 SSH 信息，填写正确的 SSH 信息后，会自动导入
2.  如果选择手动安装，点击导入后会立即成功，后续可点击主机中的“等待手动导入”按钮，生成导入脚本，在虚机中执行即可。

#### 4.3.1.2 在虚拟机上通过执行脚本导入 {#4-3-1-2}

1）在主机列表界面，点击导入主机

2）在弹出界面中选择执行脚本导入，点击下一步弹出脚本内容页面，注意选择 Linux 导入脚本，然后复制脚本。

3）在待导入主机上，以 root 用户身份执行刚才复制的脚本，不出意外，脚本执行成功后会提示，之后在 FIT2CLOUD 中会自动出现导入的主机。

#### 4.3.1.3 通过 SSH （或 CSV 文件批量）导入 {#4-3-1-3-ssh-csv}

1）在主机列表界面，点击导入主机

2）在弹出界面中选择 SSH 方式导入单台主机，输入 SSH 信息，注意：如果是 SSH 是非 root 用户登录，确保该用户可以通过 sudo 无密码获取 root 权限，则也可以正常导入。

3）在弹出界面中选择 SSH方式导入多台主机 (CSV)，点击下一步，会提示上传 CSV 文件，界面中有相应示例文件下载。

### 4.3.2 Windows 主机导入 {#4-3-2-windows}

Windows 主机目前支持 Windows 2013 后所有版本。Windows 导入方式目前只支持通过执行脚本导入。具体步骤如下：

1）在主机列表界面，点击导入主机

2）在弹出界面中选择在主机上执行脚本导入，点击下一步弹出脚本内容页面，注意选择 Windows 导入脚本，然后复制脚本。

3）在待导入主机上，以 administrator 用户身份，通过 CMD 或者 Powershell 执行刚才复制的脚本，不出意外，脚本执行成功后会提示，之后在 FIT2CLOUD 中会自动出现导入的主机。

### 4.3.3 AIX 主机导入 {#4-3-3-aix}

AIX 是 IBM 旗下的小型机操作系统，广泛的用于金融系统中，其内核基于 Linux，目前支持通过执行脚本的方式导入。具体步骤如下：

1）下载导入依赖包，并上传到AIX主机，下载地址：http://f2c-repo-pub.oss-cn-hangzhou.aliyuncs.com/eventagent/aix/f2c-aix-runtimes-0.1.tar.gz

2）登录AIX，安装导入依赖包，正常情况下，会提示安装成功。

| cd **/**opt**/**fit2cloudgzip **-**d f2c**-**aix**-**runtimes**-**0.1**.**tar**.**gztar **-**xvf f2c**-**aix**-**runtimes**-**0.1**.**tarcd f2c**-**aix**-**runtimes**-**0.1rpm **-**ivh wget**-**1.9**.**1**-**1.aix5**.**1.ppc**.**rpmrpm **-**ivh unzip**-**5.51**-**1.aix5**.**1.ppc**.**rpmrpm **-**ivh bash**-**4.2**-**3.aix6**.**1.ppc**.**rpmbash install**.**sh |
| --- |

3）在主机界面，点击导入主机，选择执行脚本导入，选择 AIX，复制脚本到 AIX 主机执行，正常情况下会提示导入主机成功，在主机页面上会出现相应的主机信息。

## 4.4 主机创建与管理 {#4-4}

FIT2CLOUD 具备自服务能力，通过 FIT2CLOUD，可以快速的创建各个云平台上的主机资源，在创建之前，先要创建主机创建模版。

### 4.4.1 主机创建模版 {#4-4-1}

虚机创建模板，英文叫LaunchConfiguration，是指基于不同的[云插件](http://docs.fit2cloud.com/v1.1/usersetting/cloud-account-setting.html#1.1-云插件), 为创建云主机预设的各种配置的静态集合，包括创建云主机使用的镜像类型、CPU 内存大小、区域、磁盘设置、网络设置等。

基于某个[云插件](http://docs.fit2cloud.com/v1.1/usersetting/cloud-account-setting.html#1.1-云插件)，可以创建多个虚机创建模版， 通过每个模版，可以创建多个相同配置的云主机。例如，通过 FIT2CLOUD 阿里云插件，创建一个 MySQL 的虚机创建模版 和一个 WordPress 的虚机创建模版，以这两个模版，可以分别在阿里云平台上启动 1 台 MySQL 云主机，2 台相同配置 WordPress 云主机。

创建主机模版具体步骤如下：

1）在设置-》主机创建模版设置中点击新建

2）弹出窗口中会提示选择具体用哪个云账号创建，以及安装 agent 的方式基础信息

1.  不同的云平台，对于 Agent 安装方的支持也不一样，比如 AWS 和青云都支持 Userdata 方式安装 Agent，即不需要任何登录信息。
2.  对于其他云平台需要自动安装 Agent 的，需要提供 SSH 登录信息，密码和密钥信息需要提前在设置-》密码密钥管理中配置。

3）点击下一步进入具体云平台主机信息页面，这里会根据不同的云平台生成不同的主机模版信息，可以依据需求，选择或者填写相应的主机信息，比如镜像、主机启动区域、CPU、内存大小、网络带宽等。

1.  对于 root 密码这里，如果前面选择了自动安装 agent 且不是 userdata 方式安装，这里的密码必须和前面的自动安装 agent 的密码一致。
2.  这个界面里面类似网络设置等，都是各个云平台中预先设置好的，主机创建模版不支持动态新建／修改这些设置。

### 4.4.2 创建主机 {#4-4-2}

1）主机模版创建完毕后，切换回主机页面，点击创建主机按钮

2）在弹出窗口中选择需要采用的主机模版，确定之后，系统就会在后台开始创建。

3）正常情况下，主机页面中会显示创建成功的主机。

1.  如果创建失败，会有红色按钮提示，一般会1\. 云平台钱不够；2\. 云平台调用 API 出错等等。
2.  如果选择手动安装 agent，会出现黄色按钮提示安装 agent 脚本

### 4.4.3 删除主机 {#4-4-3}

对于用完的主机，可以选择删除，分两种情况：

1）对于创建的主机，点击主机页面的更多操作-》删除主机，会调用云平台 API 删除主机

2）对于导入的主机，点击主机页面的更多操作-》删除主机，仅仅删除 FIT2CLOUD 上主机记录，不会影响原来主机运行。

## 4.5 主机登录 {#4-5}

在 FIT2CLOUD 主机页面中，主机列表的右边操作列表中，点击登录主机，会新建标签页，在标签页中可以通过浏览器登录主机。

1）如果没有事先绑定 SSH 登录信息，在新建的标签页中会提示您输入用户名，密码以及 SSH 端口。

2）变更 SSH 端口请点击更多操作-》变更 SSH 端口

3）绑定 SSH 密码密钥请点击更多操作-》绑定密码密钥，密码密钥需要事先在设置-》密码密钥设置中添加。

## 4.6 主机监控查看 {#4-6}

在主机页面，右边操作查看监控信息，可以获取到当前主机的基础监控信息和自定义监控信息，具体自定义监控信息的配置可以参考监控章节。

## 4.7 主机标签 {#4-7}

FIT2CLOUD 可以为主机以各种维度设置标签。具体操作步骤为在主机页面上，更多操作-》设置标签。FIT2CLOUD 可以设置任意多的标签。